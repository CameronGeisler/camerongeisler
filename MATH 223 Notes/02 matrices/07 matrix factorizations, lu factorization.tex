\documentclass[letterpaper,12pt]{article}
\input{preamble}

\chead{Matrix Factorizations, LU Factorization}

\begin{document}

Recall that factoring an algebraic expression involves writing it as a product of two or more expressions, and is helpful in various ways. A \textbf{factorization} of a matrix $A$ expresses it as a product of two or more matrices.

\section*{LU Factorization}

Let $A$ be an $m \times n$ matrix. Assume that $A$ can be row reduced to echelon form, without row interchanges. Then, $A$ can be written in the form $A = LU$, where $L$ is an $m \times m$ lower triangular matrix, and $U$ is an $m \times n$ upper triangular matrix. The matrix $U$ is a REF of $A$, and so is naturally upper triangular. The matrix $L$ is the product of the elementary matrices which were used to convert $A$ to $U$, so it just the identity matrix with additional non-zero entries below the diagonal, corresponding to the row replacements and scaling row operations.
\begin{equation*}
    \begin{array}{rcc}
        A = & \begin{bmatrix} 1 & 0 & 0 & 0 \\ \ast & 1 & 0 & 0 \\ \ast & \ast & 1 & 0 \\ \ast & \ast & \ast & 1 \end{bmatrix} & \begin{bmatrix} \blacksquare & \ast & \ast & \ast & \ast \\
        0 & \blacksquare & \ast & \ast & \ast \\
        0 & 0 & 0 & \blacksquare & \ast \\
        0 & 0 & 0 & 0 & 0 \end{bmatrix} \\
        & L & U
    \end{array}
\end{equation*}
This is an \textbf{LU factorization} of $A$. The matrix $L$ is called \textbf{unit lower triangular} (or \textbf{ULT}), because it is lower triangular and has all ones on the main diagonal.
\\ \\ If such a factorization $A = LU$ exists, then the equation becomes,
\begin{equation*}
    LU\vec{x} = \vec{b} \qquad \text{or} \qquad L(U\vec{x}) = \vec{b}
\end{equation*}
To solve this system for $\vec{x}$, we can instead solve the pair of systems
\begin{equation*}
    \begin{cases} L\vec{y} = \vec{b} \\ U\vec{x} = \vec{y} \end{cases}
\end{equation*}
Notice that here, we have represented by $U\vec{x}$ as $\vec{y}$. First, solve $L\vec{y} = \vec{b}$ for $\vec{y}$, and then with that vector $\vec{y}$, solve $U\vec{x} = \vec{y}$ for $\vec{x}$. Each of these systems is easy to solve because the coefficient matrices $L, U$ are triangular.
\\ \\ Intuitively, we are ``peeling back the layers" of $L(U\vec{x}) = \vec{b}$. First, determine what the vector $U\vec{x}$ (labelled as $\vec{y}$) needs to be to satisfy $L(U\vec{x}) = \vec{b}$, and then determine what $\vec{x}$ must be such that $U\vec{x} = \vec{y}$.

\section*{Performing LU Factorization}
If $A$ can be reduced to an echelon form $U$ using only row replacements which add a multiple of one row to another row \textit{below it}, then there exists elementary matrices $E_1, \dots, E_p$ which are unit lower triangular, such that
\begin{equation*}
    E_p \cdots E_1 A = U
\end{equation*}
Then,
\begin{align*}
    A & = (E_p \cdots E_1)^{-1} U
\end{align*}
Thus, $A = LU$ where $L = (E_p \cdots E_1)^{-1}$. In fact, $L$ is ULT, as the product of ULT matrices is ULT, and the inverse of a ULT matrix is ULT.

\begin{theorem}
\textbf{Product of ULT is ULT}. The product of unit lower triangular matrices is unit lower triangular.
\end{theorem}

\begin{proof}
Let $A, B$ be ULT. Then,
\begin{align*}
    (AB)_{ij} = \sum_{k=1}^n A_{ik} B_{kj}
\end{align*}
Consider $i < j$ (entries above the diagonal),
\begin{itemize}
    \item For $k < j$, $B_{kj} = 0$, so $A_{ik} B_{kj} = 0$.
    \item For $k \geq j$, $k \geq j > i$, so $A_{ik} = 0$, and so $A_{ik} B_{kj} = 0$.
\end{itemize}
Thus, $(AB)_{ij} = 0$. Then, consider $i = j$ (entries on the diagonal).
\begin{itemize}
    \item For $k > i$, $A_{ik} = 0$, so $A_{ik} B_{kj} = 0$.
    \item For $k < i$, $B_{ki} = 0$, so $A_{ik} B_{kj} = 0$.
    \item For $k = i$, $A_{ii} = B_{ii} = 1$, so $A_{ii} B_{ii} = 1$. Thus, $(AB)_{ii} = 1$.
\end{itemize}
\end{proof}

\begin{theorem}
\textbf{Inverse of ULT is ULT}. If $A$ is ULT, then $A$ is invertible, and $A^{-1}$ is also ULT.
\end{theorem}

To prove this, we will prove that $A$ is row equivalent to $I$.

\begin{proof}
The entries below the $(1,1)$-entry $a_{11} = 1$ can be changed to 0 by adding a multiple of row 1. Since row 1 has no other non-zero entries, the $(2,2)$-entry is unaffected. Also, this row operation only affects the first column of $I$, below the main diagonal. Next, the $(2,2)$-entry is the next pivot, which can be used to change all entries below it to 0 by row replacement. Similarly, the $(2,2)$-entry is the only non-zero entry in its row of $A$, so the other entries, in particular the $(3,3)$-entry, is not affected. Also, this row operation only affects the 2nd column of $I$, below the main diagonal. Continuing in this way, the diagonal entries are all of the pivots, and $A$ is reduced to $I$, so $A$ is invertible, and the augmented matrix is $\begin{bmatrix} I & A^{-1} \end{bmatrix}$. Each row operation only adds multiples of the pivot rows to rows below it, so $A^{-1}$ is unit lower triangular.
\end{proof}

\section*{Algorithm for LU Factorization}



\end{document}