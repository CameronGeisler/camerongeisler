\documentclass[letterpaper,12pt]{article}
\input{preamble}

\chead{Applications}

\begin{document}


\section*{Fibonacci Rabbits as a Dynamical System}
Fibonacci starts with 1 pair of adult rabbits. After each month, each pair of adult rabbits produces two pairs of juvenile rabbits. After one month, each pair of juvenile rabbits becomes a pair of adult rabbits. Determine the number of rabbits after $n$ months.
\\ \\ This forms a \textbf{dynamical system} (in particular, a \textbf{discrete dynamical system}), or an \textbf{initial value problem}.
\\ \\ Define the \textbf{state vector} $r$ of the dynamical system as
\begin{equation*}
    r = \begin{pmatrix} j \\ a \end{pmatrix} = j \begin{pmatrix} 1 \\ 0 \end{pmatrix} + a \begin{pmatrix} 0 \\ 1 \end{pmatrix} = j e_1 + a e_2
\end{equation*}
that form a vector space in $\mathbb{R}^2$. The coordinates of $r$ in the standard basis $e_1$, $e_2$ are $j$, $a$.
\begin{itemize}
    \item $r$ is the \textbf{state vector}, or in this case, the rabbit vector.
    \item $j$ is the number of juvenile rabbits
    \item $a$ is the number of adult rabbits
    \item $r_n = \begin{pmatrix} j_n \\ a_n \end{pmatrix}$ is the rabbit vector after $n$ months
\end{itemize}
Then,
\begin{itemize}
    \item $j_{n+1} = 2a_n$, since each adult rabbit produces two pairs of offspring
    \item $a_{n+1} = j_n + a_n$, as all adults stay adults, and all juveniles become adults
\end{itemize}
Then,
\begin{align*}
    r_{n+1} = \begin{pmatrix} j_{n+1} \\ a_{n+1} \end{pmatrix} = \begin{pmatrix} 2a_n \\ j_n + a_n \end{pmatrix} = \begin{pmatrix} 0 & 2 \\ 1 & 1 \end{pmatrix} \begin{pmatrix} j_n \\ a_n \end{pmatrix}
\end{align*}
We can write $r_{n+1} = Ar_n$, where $A = \begin{pmatrix} 0 & 2 \\ 1 & 1 \end{pmatrix}$ is the \textbf{transition matrix}, with $r_0 = \begin{pmatrix} 1 \\ 0 \end{pmatrix}$.
\\ \\ $A: \mathbb{R}^2 \rightarrow \mathbb{R}^2$ is linear, so $r_{n+1}$ is dependent on $r_n$ linearly. In other words,
\begin{align*}
    r_0 & = r_0\\
    r_1 & = Ar_0 \\
    r_2 & = Ar_1 = A(Ar_0) = A^2r_0 \\
    \vdots & \\
    r_n & = A^n r_0
\end{align*}

However, calculating powers of $A$ is difficult for large values of $n$. We need eigenvalues.
\\ \\ We want to find a line $L$ such that if $r_n \in L$, then $r_{n+1} \in L$. In other words, $r_{n+1}$ is a constant multiple of $r_n$, and so $Ar_n = r_{n+1} = \lambda r_n$ for some $\lambda \in \mathbb{R}$. To find the eigenvalues, find the roots of the characteristic polynomial,
\begin{align*}
    0 = P_{A}(\lambda) & = \det{(A - \lambda I_2)} \\
    & = \det{\begin{pmatrix} -\lambda & 2 \\ 1 & 1 - \lambda \end{pmatrix}} \\
    & = \lambda^2 - \lambda - 2 \\
    0 & = (\lambda - 2)(\lambda + 1)
\end{align*}
Thus, $\lambda = 2, -1$. Determine an eigenbasis. For $\lambda = 2$,
\begin{align*}
    \ker{(A - 2 I_2)} & = \ker{\begin{pmatrix} -2 & 2 \\ 1 & -1 \end{pmatrix}} = \ker{\begin{pmatrix} 1 & -1 \\ 0 & 0 \end{pmatrix}} \implies x = \set{x_2 \begin{pmatrix} 1 \\ 1 \end{pmatrix}: x_2 \in \mathbb{R}}
\end{align*}
For $\lambda = -1$,
\begin{align*}
    \ker{(A + I_2)} = \ker{\begin{pmatrix} 1 & 2 \\ 1 & 2 \end{pmatrix}} = \ker{\begin{pmatrix} 1 & 2 \\ 0 & 0 \end{pmatrix}} \implies x = \set{x_2 \begin{pmatrix} -2 \\ 1 \end{pmatrix}: x_2 \in \mathbb{R}}
\end{align*}
Thus, an eigenbasis is $\set{\begin{pmatrix} 1 \\ 1 \end{pmatrix}, \begin{pmatrix} -2 \\ 1 \end{pmatrix}}$
\\ \\ Thus, the solution space $L = \Span{\begin{pmatrix} 1 \\ 1 \end{pmatrix}}$.
\\ \\ If the initial condition had been $j_0 = a_0$, i.e. $r_0 \in L$, then $r_n = A^n r_0 = 2^n r_0$.
\\ \\ For every initial condition, it can be decomposed into components parallel to each eigenvector $-1$ and $2$, making it easier to predict behaviour.

Then, we can write $r_n$ with coordinates $c$ and $d$ in terms of the basis of eigenvalues,
\begin{equation*}
    r_n = c_n \begin{pmatrix} 1 \\ 1 \end{pmatrix} + d_n \begin{pmatrix} -2 \\ 1 \end{pmatrix}
\end{equation*}
Then,
\begin{align*}
    r_{n+1} & = Ar_n \\
    & = \begin{pmatrix} 0 & 2 \\ 1 & 1 \end{pmatrix} \begin{pmatrix} c_n - 2d_n \\ c_n + d_n \end{pmatrix} \\
    & = (2c_n) \begin{pmatrix} 1 \\ 1 \end{pmatrix} + (-d_n) \begin{pmatrix} -2 \\ 1 \end{pmatrix}
\end{align*}
Thus, $c_{n+1} = 2c_n$, and $d_{n+1} = -d_n$. By representing the dynamical system in coordinates with respect to a basis consisting of eigenvectors, the transition matrix $A$ is \textbf{decoupled}, as $c_{n+1}$ does not depend on $d_n$, and $d_{n+1}$ does not depend on $c_n$. The general solution can be written as $c_n = 2^n c_0$, and $d_n = (-1)^n d_0$
\\ \\ Then, for the eigenbasis $B$,
\begin{align*}
    [r_n]_{B} & = \begin{pmatrix} c_n \\ d_n \end{pmatrix} \\
    & = \begin{pmatrix} 2^n & 0 \\ 0 & (-1)^n \end{pmatrix} \begin{pmatrix} c_0 \\ d_0 \end{pmatrix} \\
    [r_n]_{B} & = \begin{pmatrix} 2^n & 0 \\ 0 & (-1)^n \end{pmatrix} [r_0]_{B}
\end{align*}
This gives a formula for $r_n$ in terms of $r_0$ expressed in the basis $B$.
\begin{align*}
    [r_n]_{S} = P [r_n]_{B} = P \begin{pmatrix} 2^n & 0 \\ 0 & (-1)^n \end{pmatrix} P^{-1}
\end{align*}
where $P$ is the change of basis matrix, $P = \begin{pmatrix} 1 & -2 \\ 1 & 1 \end{pmatrix}$
\\ The dynamical system is solved, as you can determine $P^{-1}$ and find an explicit formula for $[r_n]_{S}$
\begin{align*}
    r_n & = [r_n]_{S} \\
    & = P \begin{pmatrix} 2^n & 0 \\ 0 & (-1)^n \end{pmatrix} [r_0]_{B} \\
    & = \begin{pmatrix} 1 & 2 \\ 1 & -1 \end{pmatrix} \begin{pmatrix} 2^n & 0 \\ 0 & (-1)^n \end{pmatrix} \begin{pmatrix} c_0 \\ d_0 \end{pmatrix} \\
    & = c_0 2^n \begin{pmatrix} 1 \\ 1 \end{pmatrix} + d_0 (-1)^n \begin{pmatrix} 2 \\ -1 \end{pmatrix}
\end{align*}
This is the general solution of the dynamical system (with undetermined coefficients).

\section*{Section}
Diagonalization is important for dynamical systems.
\begin{example}
$A = \begin{pmatrix} 0 & 2 \\ 1 & 1 \end{pmatrix}$, $x_0 = \begin{pmatrix} 1 \\ 0 \end{pmatrix}$, $x_{n+1} = Ax_n$.
\\ \\ $B = \begin{pmatrix} 1 \\ 1 \end{pmatrix}, \begin{pmatrix} 2 \\ -1 \end{pmatrix}$ is a basis of $\mathbb{R}^2$ of eigenvectors of $A$ with eigenvalues $2$, $-1$.
\end{example}
In general, suppose $A$ is diagonalizable, $v_1, \dots, v_n$ eigenbasis with $\lambda_1, \dots, \lambda_n$ corresponding eigenvalues. Then, $x_0 = c_1v_1 + \dots + c_nv_n$ for $c_1, \dots, c_n$ ``undetermined coefficients"
\\ \\ $x_n = A^n x_0 = x_1A^nv_1 + \dots c_nA^nv_n$
\\ $\boxed{x_n = c_1 \lambda_1^n v_1 + \dots + c_n \lambda^n v_n}$
\\ is the general solution of the dynamical system $x_{n+1} = Ax_n$.

\begin{align*}
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} & = c_1 \begin{pmatrix} 1 \\ 1 \end{pmatrix} + c_2 \begin{pmatrix} 2 \\ -1 \end{pmatrix} \\
    r_n & = c_1 2^n \begin{pmatrix} 1 \\ 1 \end{pmatrix} + c_2 (-1)^n \begin{pmatrix} 2 \\ -1 \end{pmatrix}
\end{align*}
$c_1$ and $c_2$ can be determined from the initial conditions. we get $c_1 = c_2 = 1/3$.
\begin{align*}
    r_n & = \dfrac{1}{3} 2^n \begin{pmatrix} 1 \\ 1 \end{pmatrix} + \dfrac{1}{3} (-1)^n \begin{pmatrix} 2 \\ -1 \end{pmatrix} \\
    & = \dfrac{1}{3}\begin{pmatrix} 2^n + 2(-1)^n \\ 2^n - (-1)^n \end{pmatrix}
\end{align*}
Then,
\begin{align*}
    j_n & = \dfrac{1}{3}(2^n + 2(-1)^n) \\
    a_n & = \dfrac{1}{3}(2^n - (-1)^n)
\end{align*}
Alternatively, again assuming $A$ is diagonalizable,
\begin{align*}
    A = PDP^{-1}
\end{align*}
where $P$ is the change of basis matrix (with columns as eigenvectors), $D$ is the diagonal matrix with eigenvalues on the diagonals. Then,
\begin{align*}
    A^n & = PDP^{-1} \cdot PDP^{-1} \cdot \dots \cdot PDP^{-1} \\
    & = PD^n P^{-1}
\end{align*}
And $D^n$ is just $D$ when raising each diagonal element to the $n$ power.
\\ \\ Then, $x_n = A^n x_0 = PD^n P^{-1}x_0$.

If $\lambda$ is and eigenvalue of the endomorhphism $f: V \rightarrow V$, $\ker{(\lambda Id_{V} - f)} = E_{\lambda}$ the corresponding eigenspace. $\dim{E_{\lambda}}$ is the \textbf{geometric multiplicity} of $\lambda$.
\\ \\ If $\lambda_1, \dots, \lambda_k$ are distinct eigenvalues of $f$, and $B_i$ is a basis of $E_{\lambda_i}$, then $(B_1, \dots, B_k)$ is linearly independent. Then, the sum of the geometric multiplicities is less than equal to $\dim{V}$. with equality if and only if $f$ is diagonalizable.

\section*{Rabbits}
Then, we can determine the growth rate. $j_n = c_0 2^n + 2 d_0 (-1)^n$, and so
\begin{align*}
    \lim_{n \to \infty} \dfrac{j_{n+1}}{j_n} & = \lim_{n \to \infty} \dfrac{c_0 2^{n+1} + 2 d_0 (-1)^{n+1}}{c_0 2^n + 2 d_0 (-1)^n} \\
    & = \lim_{n \to \infty} \dfrac{2c_0 + 2 d_0 \frac{(-1)^{n+1}}{2^n}}{c_0 + 2 d_0 \frac{(-1)^n}{2^n}} \\
    & = \dfrac{2c_0}{c_0} \\
    & = 2
\end{align*}
for $c_0 \neq 0$. The limiting growth rate of $j$ is $2$. Similarly, the limiting growth rate of $a$, (if $d_0 \neq 0$) is $2$. Notice that $2 > \abs{-1}$.
\\ \\ In general, if $A$ is diagonalizable and $\lambda_1$ is an eigenvalue, and  $\lambda_1 > \lambda_i$ for all eigenvalues, then $\lambda_1$ is the limiting growth rate of the state vector is $\lambda_1$. In other words, $\lambda_1$ determines the long term behavior of the state vector.
\\ \\ Also, $\lim_{n \to \infty} j_n / a_n = 1$.

\section*{Application: Search Engines}

\end{document}